import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as n,f as e}from"./app-CgReBuZQ.js";const i={},l=e(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull gitlab/gitlab-ce:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在宿主机递归创建目录，即使上级目录不存在，会按目录层级自动创建目录</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /usr/local/gitlab/config

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /usr/local/gitlab/logs

<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /usr/local/gitlab/data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建并编辑 <code>gitlab_start.sh</code> 文件</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">touch</span> gitlab_start.sh

<span class="token function">vim</span> gitlab_start.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将以下内容复制进去</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token assign-left variable">GITLAB_HOME</span><span class="token operator">=</span>/usr/local/gitlab
<span class="token function">sudo</span> <span class="token function">docker</span> run <span class="token parameter variable">-dp</span> <span class="token number">443</span>:443 <span class="token parameter variable">-p</span> <span class="token number">8088</span>:80 <span class="token parameter variable">-p</span> <span class="token number">10080</span>:22 <span class="token parameter variable">-h</span> localhost <span class="token punctuation">\\</span>
    <span class="token parameter variable">--name</span> gitlab <span class="token punctuation">\\</span>
    <span class="token parameter variable">--restart</span> always <span class="token punctuation">\\</span>
    <span class="token parameter variable">--volume</span> <span class="token variable">$GITLAB_HOME</span>/config:/etc/gitlab <span class="token punctuation">\\</span>
    <span class="token parameter variable">--volume</span> <span class="token variable">$GITLAB_HOME</span>/logs:/var/log/gitlab <span class="token punctuation">\\</span>
    <span class="token parameter variable">--volume</span> <span class="token variable">$GITLAB_HOME</span>/data:/var/opt/gitlab <span class="token punctuation">\\</span>
    gitlab/gitlab-ce:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在该文件目录下，授予 <code>gitlab_start.sh</code> 执行权限</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">chmod</span> +x gitlab_start.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>执行脚本</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>./gitlab_start.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改gitlab配置文件</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">vi</span> /usr/local/gitlab/config/gitlab.rb

gitlab_rails<span class="token punctuation">[</span><span class="token string">&#39;gitlab_shell_ssh_port&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10080</span>

external_url <span class="token string">&#39;http://localhost&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="应用配置-重启服务" tabindex="-1"><a class="header-anchor" href="#应用配置-重启服务"><span>应用配置，重启服务</span></a></h2><p>修改后不要忘记重启</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> restart gitlab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>进入gitlab bash</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> gitlab <span class="token function">bash</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>重新应用gitlab的配置</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>gitlab-ctl reconfigure
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>重启gitlab服务</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>gitlab-ctl restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看gitlab运行状态</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>gitlab-ctl status
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="gitlab默认密码" tabindex="-1"><a class="header-anchor" href="#gitlab默认密码"><span>GitLab默认密码</span></a></h2><p>初次安装Gitlab时，密码放在了一个临时文件中了</p><p>在container里面： <code>/etc/gitlab/initial_root_password</code></p><p>这个文件将在首次执行reconfigure后24小时自动删除</p><p>进去之后需要修改密码</p>`,29),t=[l];function d(r,c){return s(),n("div",null,t)}const b=a(i,[["render",d],["__file","安装Gitlab.html.vue"]]);export{b as default};
