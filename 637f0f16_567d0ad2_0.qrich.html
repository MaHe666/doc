<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<meta name="qrichtext" content="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
</head>
<body style="font-family:'微软雅黑'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin:0px;">列表推导式创建列表的方式更简洁。常见的用法为，对序列或可迭代对象中的每个元素应用某种操作，用生成的结果创建新的列表；或用满足特定条件的元素创建子序列。</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">例如，创建平方值的列表：</p>
<p style="margin:0px;"><span style="font-family:'Courier';">squares = []</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">range</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">10</span><span style="font-family:'Courier';">):</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    squares</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">append(x**</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">)</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#204a87;">print</span><span style="font-family:'Courier';">(squares)</span></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">注意，这段代码创建（或覆盖）变量 x，该变量在循环结束后仍然存在。下述方法可以无副作用地计算平方列表</p>
<p style="margin:0px;"><span style="font-family:'Courier';">squares = </span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">list</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">map</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">lambda</span><span style="font-family:'Courier';"> x: x**</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">range</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">10</span><span style="font-family:'Courier';">)))</span></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">或等价于：</p>
<p style="margin:0px;"><span style="font-family:'Courier';">squares = [x**</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">range</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">10</span><span style="font-family:'Courier';">)]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">上面这种写法更简洁、易读。</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">列表推导式的方括号内包含以下内容：一个表达式，后面为一个 for 子句，然后，是零个或多个 for 或 if 子句。结果是由表达式依据 for 和 if 子句求值计算而得出一个新列表。 举例来说，以下列表推导式将两个列表中不相等的元素组合起来：</p>
<p style="margin:0px;"><span style="font-family:'Courier';">[(x, y) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">3</span><span style="font-family:'Courier';">] </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> y </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">3</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">4</span><span style="font-family:'Courier';">] </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> x != y]</span></p>
<p style="margin:0px;">结果是</p>
<p style="margin:0px;">[(1, 3), (1, 4), (2, 3), (2, 1), (2, 4), (3, 1), (3, 4)]</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">等价于：</p>
<p style="margin:0px;"><span style="font-family:'Courier';">combs = []</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">3</span><span style="font-family:'Courier';">]:</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> y </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">3</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">4</span><span style="font-family:'Courier';">]:</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> x != y:</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            combs</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">append((x, y))</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#204a87;">print</span><span style="font-family:'Courier';">(combs)</span></p>
<p style="margin:0px;">注意，上面两段代码中，for 和 if 的顺序相同。</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">表达式是元组（例如上例的 (x, y)）时，必须加上括号，否则就会报错</p>
<p style="margin:0px;"><span style="font-family:'Courier';">vec = [-</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">4</span><span style="font-family:'Courier';">, -</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">0</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">4</span><span style="font-family:'Courier';">]</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># create a new list with the values doubled</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[x*</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> vec]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># filter the list to exclude negative numbers</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> vec </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> x &gt;= </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">0</span><span style="font-family:'Courier';">]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># apply a function to all the elements</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[</span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">abs</span><span style="font-family:'Courier';">(x) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> vec]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># call a method on each element</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">freshfruit = [</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">'  banana'</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">'  loganberry '</span><span style="font-family:'Courier';">, </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">'passion fruit  '</span><span style="font-family:'Courier';">]</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[weapon</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">strip() </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> weapon </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> freshfruit]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># create a list of 2-tuples like (number, square)</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[(x, x**</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> x </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#204a87;">range</span><span style="font-family:'Courier';">(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">6</span><span style="font-family:'Courier';">)]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;"># flatten a list using a listcomp with two 'for'</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">vec = [[</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">2</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">3</span><span style="font-family:'Courier';">], [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">4</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">5</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">6</span><span style="font-family:'Courier';">], [</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">7</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">8</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">9</span><span style="font-family:'Courier';">]]</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">[num </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> elem </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> vec </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> num </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">in</span><span style="font-family:'Courier';"> elem]</span></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>

<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>