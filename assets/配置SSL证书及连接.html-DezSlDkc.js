import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,o as i,f as t}from"./app-NfaswYlV.js";const a={},n=t(`<p>相关文章：<a href="https://blog.51cto.com/moerjinrong/2367282" target="_blank" rel="noopener noreferrer">https://blog.51cto.com/moerjinrong/2367282</a></p><p>证书生成后，如果数据库中ssl没有生效，需要把如下语句加到配置文件，并重启mysql服务：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>ssl-ca = /var/lib/mysql/ca.pem</span></span>
<span class="line"><span>ssl-cert = /var/lib/mysql/server-cert.pem</span></span>
<span class="line"><span>ssl-key = /var/lib/mysql/server-key.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Springboot连接，相关文章：<a href="https://juejin.cn/s/spring%20boot%20connect%20mysql%20ssl" target="_blank" rel="noopener noreferrer">https://juejin.cn/s/spring boot connect mysql ssl</a></p><h2 id="生成客户端证书" tabindex="-1"><a class="header-anchor" href="#生成客户端证书"><span>生成客户端证书</span></a></h2><p>进入到三个原始客户端文件所在的文件夹中：<code>ca.pem</code>、<code>client-key.pem</code>、<code>client-cert.pem</code></p><p>生成文件：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>keytool -importcert -alias Cacert -file ca.pem  -keystore truststoremysql -storepass 123456</span></span>
<span class="line"><span></span></span>
<span class="line"><span>openssl pkcs12 -export -in client-cert.pem -inkey client-key.pem -name &quot;mysqlclient&quot; -passout pass:123456 -out client-keystore.p12</span></span>
<span class="line"><span></span></span>
<span class="line"><span>keytool -importkeystore -srckeystore client-keystore.p12 -srcstoretype pkcs12 -srcstorepass 123456 -destkeystore keystoremysql -deststoretype JKS -deststorepass 123456</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述命令中的123456是密码，这个密码可以改变，但是必须保证全部一样</p><p>SpringBoot 配置文件中，jdbc的url参数</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>useSSL=true&amp;verifyServerCertificate=true&amp;requireSSL=true&amp;clientCertificateKeyStoreUrl=file:所在文件夹路径/keystoremysql&amp;clientCertificateKeyStorePassword=123456&amp;trustCertificateKeyStoreUrl=file:所在文件夹路径/truststoremysql&amp;trustCertificateKeyStorePassword=123456</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="可能出现的问题" tabindex="-1"><a class="header-anchor" href="#可能出现的问题"><span>可能出现的问题</span></a></h2><p><code>SSL Peer Shut down Incorrectly</code></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>看一下mysql驱动版本是否正确，5.7版本的mysql需要使用5.1.x版本的mysql-connector-java驱动</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>no appropriate protocol (protocol is disabled or cipher suites are inappropriate)</code></p><p>在linux系统中</p><p>使用命令 <code>find / -name java.security</code> 查找java.security文件</p><p>在文件中找到 <code>jdk.tls.disabledAlgorithms=</code></p><p>大概长这样</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Example:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#   jdk.tls.disabledAlgorithms=MD5, SSLv3, DSA, RSA keySize &lt; 2048</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jdk.tls.disabledAlgorithms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=SSLv3,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RC4,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DES,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MD5withRSA,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    DH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> keySize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1024,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> keySize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">224,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3DES_EDE_CBC,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> anon,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NULL,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jdk.disabled.namedCurves</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>解决方案</strong>：删除其中的SSLv3，TLSv1，TLSv1.1</p>`,21),l=[n];function r(p,o){return i(),e("div",null,l)}const c=s(a,[["render",r],["__file","配置SSL证书及连接.html.vue"]]),k=JSON.parse('{"path":"/%E8%BF%90%E7%BB%B4/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux/CentOS/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/MySQL%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6%E5%8F%8A%E8%BF%9E%E6%8E%A5.html","title":"配置SSL证书及连接","lang":"zh-CN","frontmatter":{"title":"配置SSL证书及连接","order":10,"description":"相关文章：https://blog.51cto.com/moerjinrong/2367282 证书生成后，如果数据库中ssl没有生效，需要把如下语句加到配置文件，并重启mysql服务： Springboot连接，相关文章：https://juejin.cn/s/spring boot connect mysql ssl 生成客户端证书 进入到三个原始...","head":[["meta",{"property":"og:url","content":"https://mahe666.github.io/doc/%E8%BF%90%E7%BB%B4/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux/CentOS/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/MySQL%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6%E5%8F%8A%E8%BF%9E%E6%8E%A5.html"}],["meta",{"property":"og:site_name","content":"Mahe666"}],["meta",{"property":"og:title","content":"配置SSL证书及连接"}],["meta",{"property":"og:description","content":"相关文章：https://blog.51cto.com/moerjinrong/2367282 证书生成后，如果数据库中ssl没有生效，需要把如下语句加到配置文件，并重启mysql服务： Springboot连接，相关文章：https://juejin.cn/s/spring boot connect mysql ssl 生成客户端证书 进入到三个原始..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-16T11:31:59.000Z"}],["meta",{"property":"article:author","content":"Mahe666"}],["meta",{"property":"article:modified_time","content":"2024-06-16T11:31:59.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"配置SSL证书及连接\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-16T11:31:59.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mahe666\\"}]}"]]},"headers":[{"level":2,"title":"生成客户端证书","slug":"生成客户端证书","link":"#生成客户端证书","children":[]},{"level":2,"title":"可能出现的问题","slug":"可能出现的问题","link":"#可能出现的问题","children":[]}],"git":{"createdTime":1686300087000,"updatedTime":1718537519000,"contributors":[{"name":"mahe666","email":"m13234666930@163.com","commits":1}]},"filePathRelative":"运维/操作系统/Linux/CentOS/软件安装/MySQL安装及配置/配置SSL证书及连接.md","localizedDate":"2023年6月9日","autoDesc":true}');export{c as comp,k as data};
