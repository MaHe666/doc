import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as d,c as a,f as e}from"./app-CbLsyo3e.js";const p={},r=e('<h2 id="优缺点" tabindex="-1"><a class="header-anchor" href="#优缺点"><span>优缺点</span></a></h2><p>压缩的优点：以减少磁盘IO、减少磁盘存储空间。<br> 压缩的缺点：增加CPU开销。</p><h2 id="压缩原则" tabindex="-1"><a class="header-anchor" href="#压缩原则"><span>压缩原则</span></a></h2><ol><li>运算密集型的Job，少用压缩</li><li>IO密集型的Job，多用压缩</li></ol><h2 id="mapreduce支持的压缩编码" tabindex="-1"><a class="header-anchor" href="#mapreduce支持的压缩编码"><span>MapReduce支持的压缩编码</span></a></h2><table><thead><tr><th>压缩格式</th><th>Hadoop自带？</th><th>算法</th><th>文件扩展名</th><th>是否可切片</th><th>换成压缩格式后，原来的程序是否需要修改</th></tr></thead><tbody><tr><td>DEFLATE</td><td>是，直接使用</td><td>DEFLATE</td><td>.deflate</td><td>否</td><td>和文本处理一样，不需要修改</td></tr><tr><td>Gzip</td><td>是，直接使用</td><td>DEFLATE</td><td>.gz</td><td>否</td><td>和文本处理一样，不需要修改</td></tr><tr><td>bzip2</td><td>是，直接使用</td><td>bzip2</td><td>.bz2</td><td>是</td><td>和文本处理一样，不需要修改</td></tr><tr><td>LZO</td><td>否，需要安装</td><td>LZO</td><td>.lzo</td><td>是</td><td>需要建索引，还需要指定输入格式</td></tr><tr><td>Snappy</td><td>是，直接使用</td><td>Snappy</td><td>.snappy</td><td>否</td><td>和文本处理一样，不需要修改</td></tr></tbody></table><h2 id="压缩性能的比较" tabindex="-1"><a class="header-anchor" href="#压缩性能的比较"><span>压缩性能的比较</span></a></h2><table><thead><tr><th>压缩算法</th><th>原始文件大小</th><th>压缩文件大小</th><th>压缩速度</th><th>解压速度</th></tr></thead><tbody><tr><td>gzip</td><td>8.3GB</td><td>1.8GB</td><td>17.5MB/s</td><td>58MB/s</td></tr><tr><td>bzip2</td><td>8.3GB</td><td>1.1GB</td><td>2.4MB/s</td><td>9.5MB/s</td></tr><tr><td>LZO</td><td>8.3GB</td><td>2.9GB</td><td>49.3MB/s</td><td>74.6MB/s</td></tr></tbody></table><h2 id="压缩方式的选择" tabindex="-1"><a class="header-anchor" href="#压缩方式的选择"><span>压缩方式的选择</span></a></h2><p>压缩方式选择时重点考虑：<strong>压缩/解压缩速度、压缩率（压缩后存储大小）、压缩后是否可以支持切片。</strong></p><h3 id="gzip压缩" tabindex="-1"><a class="header-anchor" href="#gzip压缩"><span>Gzip压缩</span></a></h3><p>优点：压缩率比较高；<br> 缺点：不支持Split；压缩/解压速度一般；</p><h3 id="bzip2压缩" tabindex="-1"><a class="header-anchor" href="#bzip2压缩"><span>Bzip2压缩</span></a></h3><p>优点：压缩率高；支持Split；<br> 缺点：压缩/解压速度慢。</p><h3 id="lzo压缩" tabindex="-1"><a class="header-anchor" href="#lzo压缩"><span>Lzo压缩</span></a></h3><p>优点：压缩/解压速度比较快；支持Split；<br> 缺点：压缩率一般；想支持切片需要额外创建索引。</p><h3 id="snappy压缩" tabindex="-1"><a class="header-anchor" href="#snappy压缩"><span>Snappy压缩</span></a></h3><p>优点：压缩和解压缩速度快；<br> 缺点：不支持Split；压缩率一般；</p><h2 id="压缩位置选择" tabindex="-1"><a class="header-anchor" href="#压缩位置选择"><span>压缩位置选择</span></a></h2><p>压缩可以在MapReduce作用的任意阶段启用。</p><h3 id="输入端采用压缩" tabindex="-1"><a class="header-anchor" href="#输入端采用压缩"><span>输入端采用压缩</span></a></h3><p>无须显示指定使用的编解码方式。<strong>Hadoop自动检查文件扩展名，如果扩展名能够匹配就会用恰当的编解码方式对文件进行压缩和解压。</strong></p><p>企业开发考虑因素：</p><ol><li><strong>数据量小于块大小，重点考虑压缩和解压缩速度比较快的 <code>LZO</code>/<code>Snappy</code></strong></li><li><strong>数据量非常大，重点考虑支持切片的<code>Bzip2</code>和<code>LZO</code></strong></li></ol><h3 id="mapper输出采用压缩" tabindex="-1"><a class="header-anchor" href="#mapper输出采用压缩"><span>Mapper输出采用压缩</span></a></h3><p>企业开发中如何选择:为了减少MapTask和ReduceTask之间的网络IO。重点考虑压缩和解压缩快的<code>LZO</code>、<code>Snappy</code>.</p><h3 id="reducer输出采用压缩" tabindex="-1"><a class="header-anchor" href="#reducer输出采用压缩"><span>Reducer输出采用压缩</span></a></h3><p>看需求:</p><ul><li>如果数据永久保存，考虑压缩率比较高的<code>Bzip2</code>和<code>Gzip</code>。</li><li>如果作为下一个MapReduce输入，需要考虑数据量和是否支持切片。</li></ul><h2 id="压缩参数配置" tabindex="-1"><a class="header-anchor" href="#压缩参数配置"><span>压缩参数配置</span></a></h2><h3 id="_1-为了支持多种压缩-解压缩算法-hadoop引入了编码-解码器" tabindex="-1"><a class="header-anchor" href="#_1-为了支持多种压缩-解压缩算法-hadoop引入了编码-解码器"><span>1. 为了支持多种压缩/解压缩算法，Hadoop引入了编码/解码器</span></a></h3><table><thead><tr><th>压缩格式</th><th>对应的编码/解码器</th></tr></thead><tbody><tr><td>DEFLATE</td><td>org.apache.hadoop.io.compress.DefaultCodec</td></tr><tr><td>gzip</td><td>org.apache.hadoop.io.compress.GzipCodec</td></tr><tr><td>bzip2</td><td>org.apache.hadoop.io.compress.BZip2Codec</td></tr><tr><td>LZO</td><td>com.hadoop.compression.lzo.LzopCodec</td></tr><tr><td>Snappy</td><td>org.apache.hadoop.io.compress.SnappyCodec</td></tr></tbody></table><h3 id="_2-要在hadoop中启用压缩-可以配置如下参数" tabindex="-1"><a class="header-anchor" href="#_2-要在hadoop中启用压缩-可以配置如下参数"><span>2. 要在Hadoop中启用压缩，可以配置如下参数</span></a></h3><table><thead><tr><th>参数</th><th>默认值</th><th>阶段</th><th>建议</th></tr></thead><tbody><tr><td>io.compression.codecs <br>（在core-site.xml中配置）</td><td>无，这个需要在命令行输入hadoop checknative查看</td><td>输入压缩</td><td>Hadoop使用文件扩展名判断是否支持某种编解码器</td></tr><tr><td>mapreduce.map.output.compress<br>（在mapred-site.xml中配置）</td><td>false</td><td>mapper输出</td><td>这个参数设为true启用压缩</td></tr><tr><td>mapreduce.map.output.compress.codec<br>（在mapred-site.xml中配置）</td><td>org.apache.hadoop.io.compress.DefaultCodec</td><td>mapper输出</td><td>企业多使用LZO或Snappy编解码器在此阶段压缩数据</td></tr><tr><td>mapreduce.output.fileoutputformat.compress<br>（在mapred-site.xml中配置）</td><td>false</td><td>reducer输出</td><td>这个参数设为true启用压缩</td></tr><tr><td>mapreduce.output.fileoutputformat.compress.codec<br>（在mapred-site.xml中配置）</td><td>org.apache.hadoop.io.compress.DefaultCodec</td><td>reducer输出</td><td>使用标准工具或者编解码器，如gzip和bzip2</td></tr></tbody></table>',34),o=[r];function h(s,c){return d(),a("div",null,o)}const l=t(p,[["render",h],["__file","数据压缩.html.vue"]]);export{l as default};
