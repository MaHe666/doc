<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<meta name="qrichtext" content="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
</head>
<body style="font-family:'微软雅黑'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">package</span><span style="font-family:'Courier';"> com</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mahe666;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> com</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">sun</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">MailSSLSocketFactory;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">activation</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">DataHandler;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">activation</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">FileDataSource;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail.*;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">internet.*;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">security</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">GeneralSecurityException;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">Properties;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">//带附件和图片的邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">class</span><span style="font-family:'Courier';"> DiffcultMail {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">void</span><span style="font-family:'Courier';"> main(String[] args) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">throws</span><span style="font-family:'Courier';"> GeneralSecurityException, MessagingException {</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Properties prop = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> Properties();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.host&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp.qq.com&quot;</span><span style="font-family:'Courier';">);   </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置qq邮件服务器</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.transport.protocol&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp&quot;</span><span style="font-family:'Courier';">);     </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//邮件发送协议</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.auth&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;true&quot;</span><span style="font-family:'Courier';">);      </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//需要验证用户密码</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//关于QQ邮箱，还要设置SSL加密，加上以下代码即可,（阿里的钉钉邮箱也需要），其他邮箱看情况是否需要</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MailSSLSocketFactory sf = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MailSSLSocketFactory();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        sf</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setTrustAllHosts(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">true</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">put(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.ssl.enable&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;true&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">put(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.ssl.socketFactory&quot;</span><span style="font-family:'Courier';">,sf);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//1，创建定义整个应用程序所需的环境信息的 Session 对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//QQ才有！其他邮箱看情况用</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Session session = Session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getDefaultInstance(prop, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> Authenticator() {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            @Override</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">protected</span><span style="font-family:'Courier';"> PasswordAuthentication getPasswordAuthentication() {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> PasswordAuthentication(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;授权码&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        });</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//开启Session的debug模式，这样就可以看到程序发送的Email的运行状态</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDebug(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">true</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//2，通过 session 得到 Transport 对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Transport ts = session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getTransport();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//3，使用邮箱的用户名和授权码连上邮件服务器</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">connect(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp.qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;授权码&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//4，创建邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//注意需要传递session</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeMessage mimeMessage = setDiffcultMail(session);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//5，发送邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">sendMessage(mimeMessage, mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getAllRecipients());</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//6，关闭连接</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">close();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> MimeMessage setDiffcultMail(Session session) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">throws</span><span style="font-family:'Courier';"> MessagingException {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//消息的固定信息</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeMessage mimeMessage = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeMessage(session);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//邮件发送人</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setFrom(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> InternetAddress(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//邮件接收人</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setRecipient(Message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">RecipientType</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">TO, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> InternetAddress(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置主题</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSubject(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;你猜这是啥邮件！&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//图片</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart body1 = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body1</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> DataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> FileDataSource(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;src/xxx.png&quot;</span><span style="font-family:'Courier';">)));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body1</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContentID(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;xxx.jpg&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//文本</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart body2 = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body2</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContent(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;请注意，我不是广告&lt;img src='cid:xxx.png'&gt;&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;text/html;charset=UTF-8&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//附件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart body3 = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body3</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> DataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> FileDataSource(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;src/xxx.xml&quot;</span><span style="font-family:'Courier';">)));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body3</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setFileName(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;xxx.xml&quot;</span><span style="font-family:'Courier';">);  </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置附件名字</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart body4 = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body4</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> DataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> FileDataSource(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;src/xxx.txt&quot;</span><span style="font-family:'Courier';">)));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        body4</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setFileName(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;xxx.txt&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//拼装邮件内容</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeMultipart mimeMultipart = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeMultipart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMultipart</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(body1);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMultipart</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(body2);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMultipart</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(body3);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMultipart</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(body4);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMultipart</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSubType(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mixed&quot;</span><span style="font-family:'Courier';">);      </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//文本，图片和附件都在邮件中，所以类型设置为mixed</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//放到Message消息中</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContent(mimeMultipart);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mimeMessage</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">saveChanges();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> mimeMessage;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">}</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>

<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>