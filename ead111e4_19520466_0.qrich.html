<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<meta name="qrichtext" content="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
</head>
<body style="font-family:'微软雅黑'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">package</span><span style="font-family:'Courier';"> com</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mahe666</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> org</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">apache</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">commons</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">fileupload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">FileItem;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> org</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">apache</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">commons</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">fileupload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">FileUploadException;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> org</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">apache</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">commons</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">fileupload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">ProgressListener;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> org</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">apache</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">commons</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">fileupload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">disk</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">DiskFileItemFactory;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> org</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">apache</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">commons</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">fileupload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">ServletFileUpload;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">ServletContext;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">ServletException;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">http</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">HttpServlet;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">http</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">HttpServletRequest;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">servlet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">http</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">HttpServletResponse;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">io.*;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">List;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">UUID;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">class</span><span style="font-family:'Courier';"> FileServlet </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">extends</span><span style="font-family:'Courier';"> HttpServlet {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">protected</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">void</span><span style="font-family:'Courier';"> doPost(HttpServletRequest request, HttpServletResponse response) {</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//判断上传的表单是普通表单还是带文件的表单</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//判断请求是否包含文件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (!ServletFileUpload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">isMultipartContent(request)) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//说明这是一个普通的表单，终止方法运行</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';">;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//创建上传文件的保存路径，建议在WEB-INF路径下，安全，用户无法直接访问上传的文件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获取全局Servlet上下文</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ServletContext servletContext = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">this</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getServletContext();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获取绝对路径</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        String uploadPath = servletContext</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getRealPath(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;/WEB-INF/upload&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//判断该文件是否存在（这里是判断路径）</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        File uploadFile = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> File(uploadPath);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//如果不存在</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (!uploadFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">exists()) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//创建这个目录</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            uploadFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mkdir();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//缓存，临时文件       (缓存之后会在mybatis中学习)</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//临时路径，假如文件超过了预期的大小，我们就把他放到一个临时文件中，过几天自动删除，或者提醒用户转存为永久</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        String tmpPath = servletContext</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getRealPath(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;/WEB-INF/tmp&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        File tmpFile = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> File(tmpPath);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (!tmpFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">exists()) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            tmpFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mkdir();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//处理上传的文件，一般都要通过流来获取，我们可以使用request.getInputStream()方法获取原生态的文件上传流，但是十分麻烦</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//建议使用 Apache 的文件上传组件 common-fileupload 来实现，它需要依赖于commons-io组件</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//1，创建 DiskFileItemFactory 磁盘文件的工厂对象，处理文件上传的路径或者文件大小的限制</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        DiskFileItemFactory factory = getDiskFileItemFactory(tmpFile);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//2，获取ServletFileUpload</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ServletFileUpload upload = getServletFileUpload(factory);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//3，处理上传的文件</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">try</span><span style="font-family:'Courier';"> {       </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">// upload.parseRequest(request) 需要抛的异常</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            String msg = upLoadParseRequest(upload, request, uploadPath);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//servlet请求转发消息</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            request</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setAttribute(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;msg&quot;</span><span style="font-family:'Courier';">, msg);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            request</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getRequestDispatcher(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;info.jsp&quot;</span><span style="font-family:'Courier';">).forward(request, response);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        } </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">catch</span><span style="font-family:'Courier';"> (FileUploadException e) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            e</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">printStackTrace();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        } </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">catch</span><span style="font-family:'Courier';"> (IOException i){</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            i</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">printStackTrace();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        } </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">catch</span><span style="font-family:'Courier';"> (ServletException s){</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            s</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">printStackTrace();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//必须使用post，所以doGet方法没有用</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">/*</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">        */</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> DiskFileItemFactory getDiskFileItemFactory(File tmpFile) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        DiskFileItemFactory factory = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> DiskFileItemFactory();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//通过这个工厂设置一个缓冲区，当上传的文件大于这个缓冲区的时候，将他放到临时文件中</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        factory</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSizeThreshold(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';">);      </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置缓存区大小为1M，也可以不写，有默认值</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        factory</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setRepository(tmpFile);         </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//临时文件的保存目录，需要一个file对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> factory;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> ServletFileUpload getServletFileUpload(DiskFileItemFactory factory) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">/*</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            ServletFileUpload 负责处理上传的文件数据,并将表单中每个输入项（除按钮外的每个input） 封装成一个 FiLeItem 对象，</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            在使用 servletFileUpLoad 对象解析请求时需要 DiskFiLeItemFactory 对象。</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            所以，我们需要在进行解析工作前构造好 DiskFileItemFactory 对象，</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">            通过 ServletFiLeUpLoad 对象的构造方法或 setFileItemFactory() 方法设置 ServletFiLeUpLoad 对象的 fileItemFactory 属性。</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">             */</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ServletFileUpload upload = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> ServletFileUpload(factory);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//监听文件上传进度</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        upload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProgressListener(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> ProgressListener() {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//pBytesRead: 已经读取到的文件大小</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//pContentLength: 文件大小</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">void</span><span style="font-family:'Courier';"> update(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">long</span><span style="font-family:'Courier';"> pBytesRead, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">long</span><span style="font-family:'Courier';"> pContentLength, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">int</span><span style="font-family:'Courier';"> pItems) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                System</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">out</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">println(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;文件总大小：&quot;</span><span style="font-family:'Courier';"> + pContentLength + </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;   已上传：&quot;</span><span style="font-family:'Courier';"> + pBytesRead);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        });</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//处理乱码问题</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//如果不设置的话，就是默认的 ISO-8859-1</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        upload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setHeaderEncoding(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;UTF-8&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置单个文件的最大 大小限制</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        upload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setFileSizeMax(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">10</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//一共能够上传文件的大小</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//1024 = 1KB * 1024 = 1MB * 10 = 10MB</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        upload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSizeMax(</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">10</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> upload;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> String upLoadParseRequest(ServletFileUpload upload, HttpServletRequest request, String uploadPath) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">throws</span><span style="font-family:'Courier';"> FileUploadException, IOException {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        String msg = </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;&quot;</span><span style="font-family:'Courier';">;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//解析前端请求，封装成一个FileItem对象，需要从 ServletFileUpload 对象中获取</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        List&lt;FileItem&gt; fileItems = upload</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">parseRequest(request);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//fileItems中可能有很多个请求，所以我们需要遍历</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//fileItem 每一个表单输入项对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">for</span><span style="font-family:'Courier';"> (FileItem fileItem : fileItems) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//判断该请求是不是文件输入项</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//如果不是文件输入项</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">isFormField()) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">// getFieldName 指的是前端表单控件的name</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String name = fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getFieldName();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String value = fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getString(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;UTF-8&quot;</span><span style="font-family:'Courier';">);     </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获取处理乱码后的值</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//不是的话就正常处理</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                System</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">out</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">println(name + </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;: &quot;</span><span style="font-family:'Courier';"> + value);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            } </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">else</span><span style="font-family:'Courier';"> {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//如果是文件输入项</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//=================================处理文件==================================//</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//拿到文件上传的名字</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String uploadFileName = fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getName();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                System</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">out</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">println(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;上传的文件名：&quot;</span><span style="font-family:'Courier';">+uploadFileName);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//可能存在文件名不合法的情况</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (uploadFileName == </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">null</span><span style="font-family:'Courier';"> || uploadFileName</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">trim().equals(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;&quot;</span><span style="font-family:'Courier';">)) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                    </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//跳过当前循环</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">continue</span><span style="font-family:'Courier';">;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获得上传的文件名      获取最后一个/后面的名字</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String fileName = uploadFileName</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">substring(uploadFileName</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">lastIndexOf(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;/&quot;</span><span style="font-family:'Courier';">) + </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获得文件的后缀名</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String fileExtName = uploadFileName</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">substring(uploadFileName</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">lastIndexOf(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;.&quot;</span><span style="font-family:'Courier';">) + </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                    </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">/*</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">                        如果文件后缀名 fileExtName 不是我们所需要的，就直接return，不处理，告诉用户文件类型不对</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">                     */</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                System</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">out</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">println(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;文件后缀名：&quot;</span><span style="font-family:'Courier';">+fileExtName);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//=================================存放地址==================================//</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//可以使用UUID（唯一识别的通用码），保证文件名唯一</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//UUID.randomUUID() ，随机生成一个唯一识别的通用码</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String uuidPath = UUID</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">randomUUID().toString();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//存放的路径是 uploadPath</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//文件真实存在的路径 realPath</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                String realPath = uploadPath + </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;/&quot;</span><span style="font-family:'Courier';"> + uuidPath;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//给文件创建一个单独的目录</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                File realPathFile = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> File(realPath);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">if</span><span style="font-family:'Courier';"> (!realPathFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">exists()) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                    realPathFile</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mkdir();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                }</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//=================================文件传输==================================//</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//获取文件上传的流</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                InputStream inputStream = fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getInputStream();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//创建一个文件输出流</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//realPath = 真实的文件夹</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//查了一个文件，加上输出文件的名字+&quot;/&quot;+uuidFileName</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                FileOutputStream fos = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> FileOutputStream(realPath + </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;/&quot;</span><span style="font-family:'Courier';"> + fileName);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//创建缓冲区</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">byte</span><span style="font-family:'Courier';">[] buffer = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">byte</span><span style="font-family:'Courier';">[</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';"> * </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">1024</span><span style="font-family:'Courier';">];</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//判断是否读取完毕</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">int</span><span style="font-family:'Courier';"> len = </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">0</span><span style="font-family:'Courier';">;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//如果大于0说明还存在数据</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">while</span><span style="font-family:'Courier';"> ((len = inputStream</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">read(buffer)) &gt; </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">0</span><span style="font-family:'Courier';">) {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                    fos</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">write(buffer, </span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">0</span><span style="font-family:'Courier';">, len);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//关闭流</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                fos</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">close();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                inputStream</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">close();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                msg = </span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;文件上传成功&quot;</span><span style="font-family:'Courier';">;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//文件上传成功，清除临时文件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                fileItem</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">delete();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">/*</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">                文件如果找不到，就去发布的路径下找WEB-INF</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">                看看能不能找到</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">                 */</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> msg;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">}</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>

<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>