<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<meta name="qrichtext" content="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
</head>
<body style="font-family:'微软雅黑'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">package</span> com<span style=" font-weight:600; color:#4682b4;">.</span>mahe666;</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>hssf<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>HSSFWorkbook;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>ss<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>Cell;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>ss<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>Row;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>ss<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>Sheet;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>ss<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>Workbook;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>xssf<span style=" font-weight:600; color:#4682b4;">.</span>streaming<span style=" font-weight:600; color:#4682b4;">.</span>SXSSFWorkbook;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>apache<span style=" font-weight:600; color:#4682b4;">.</span>poi<span style=" font-weight:600; color:#4682b4;">.</span>xssf<span style=" font-weight:600; color:#4682b4;">.</span>usermodel<span style=" font-weight:600; color:#4682b4;">.</span>XSSFWorkbook;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> org<span style=" font-weight:600; color:#4682b4;">.</span>junit<span style=" font-weight:600; color:#4682b4;">.</span>Test;</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> java<span style=" font-weight:600; color:#4682b4;">.</span>io<span style=" font-weight:600; color:#4682b4;">.</span>FileOutputStream;</p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">import</span> java<span style=" font-weight:600; color:#4682b4;">.</span>io<span style=" font-weight:600; color:#4682b4;">.</span>IOException;</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;"><span style=" font-style:italic; color:#778899;">/**</span></p>
<p style="margin:0px;"><span style=" font-style:italic; color:#778899;"> * @author ：mahe666</span></p>
<p style="margin:0px;"><span style=" font-style:italic; color:#778899;"> * @description：ExcelWriteTest02</span></p>
<p style="margin:0px;"><span style=" font-style:italic; color:#778899;"> * @date ：Created in 2021/9/4 10:38</span></p>
<p style="margin:0px;"><span style=" font-style:italic; color:#778899;"> */</span></p>
<p style="margin:0px;"><span style=" font-weight:600; color:#8b008b;">public</span> <span style=" font-weight:600; color:#8b008b;">class</span> ExcelWriteTest02 {</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">    <span style=" font-weight:600; color:#8b008b;">final</span> <span style=" font-weight:600; color:#8b008b;">static</span> String PATH = <span style=" font-weight:600; color:#2e8b57;">&quot;C:\\Users\\30704\\Desktop\\&quot;</span>;</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">    <span style=" font-style:italic; color:#778899;">//测试大数据量的写入</span></p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">    @Test</p>
<p style="margin:0px;">    <span style=" font-weight:600; color:#8b008b;">public</span> <span style=" font-weight:600; color:#8b008b;">void</span> testWrite03BigFile() <span style=" font-weight:600; color:#8b008b;">throws</span> IOException {</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//时间</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> startTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();    <span style=" font-style:italic; color:#778899;">//开始时间</span></p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建一个工作簿，使用Excel能操作的他都可以操作</span></p>
<p style="margin:0px;">        Workbook workbook = <span style=" font-weight:600; color:#8b008b;">new</span> HSSFWorkbook();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建表</span></p>
<p style="margin:0px;">        Sheet sheet = workbook<span style=" font-weight:600; color:#4682b4;">.</span>createSheet();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//写入数据</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> rowNum = <span style=" font-weight:600; color:#4682b4;">0</span>; rowNum &lt; <span style=" font-weight:600; color:#4682b4;">65536</span>; rowNum++){     <span style=" font-style:italic; color:#778899;">//循环每一行，每一列</span></p>
<p style="margin:0px;">            Row row = sheet<span style=" font-weight:600; color:#4682b4;">.</span>createRow(rowNum);</p>
<p style="margin:0px;">            <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> colNum = <span style=" font-weight:600; color:#4682b4;">0</span>; colNum &lt; <span style=" font-weight:600; color:#4682b4;">10</span>; colNum++){</p>
<p style="margin:0px;">                Cell cell = row<span style=" font-weight:600; color:#4682b4;">.</span>createCell(colNum);</p>
<p style="margin:0px;">                cell<span style=" font-weight:600; color:#4682b4;">.</span>setCellValue(colNum);</p>
<p style="margin:0px;">            }</p>
<p style="margin:0px;">        }</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        FileOutputStream fileOutputStream = <span style=" font-weight:600; color:#8b008b;">new</span> FileOutputStream(PATH + <span style=" font-weight:600; color:#2e8b57;">&quot;testWrite03BigFile.xls&quot;</span>);</p>
<p style="margin:0px;">        workbook<span style=" font-weight:600; color:#4682b4;">.</span>write(fileOutputStream);</p>
<p style="margin:0px;">        fileOutputStream<span style=" font-weight:600; color:#4682b4;">.</span>close();</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> endTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();      <span style=" font-style:italic; color:#778899;">//结束时间</span></p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println(<span style=" font-weight:600; color:#2e8b57;">&quot;over&quot;</span>);</p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println((<span style=" font-weight:600; color:#8b008b;">double</span>) (endTime-startTime)/<span style=" font-weight:600; color:#4682b4;">1000</span>);</p>
<p style="margin:0px;">    }</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">    <span style=" font-style:italic; color:#778899;">//07比03耗时长</span></p>
<p style="margin:0px;">    @Test</p>
<p style="margin:0px;">    <span style=" font-weight:600; color:#8b008b;">public</span> <span style=" font-weight:600; color:#8b008b;">void</span> testWrite07BigFile() <span style=" font-weight:600; color:#8b008b;">throws</span> IOException {</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//时间</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> startTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();    <span style=" font-style:italic; color:#778899;">//开始时间</span></p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建工作簿</span></p>
<p style="margin:0px;">        Workbook workbook = <span style=" font-weight:600; color:#8b008b;">new</span> XSSFWorkbook();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建表</span></p>
<p style="margin:0px;">        Sheet sheet = workbook<span style=" font-weight:600; color:#4682b4;">.</span>createSheet();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//写入数据</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> rowNum = <span style=" font-weight:600; color:#4682b4;">0</span>; rowNum &lt; <span style=" font-weight:600; color:#4682b4;">65536</span>; rowNum++){     <span style=" font-style:italic; color:#778899;">//循环每一行，每一列</span></p>
<p style="margin:0px;">            Row row = sheet<span style=" font-weight:600; color:#4682b4;">.</span>createRow(rowNum);</p>
<p style="margin:0px;">            <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> colNum = <span style=" font-weight:600; color:#4682b4;">0</span>; colNum &lt; <span style=" font-weight:600; color:#4682b4;">10</span>; colNum++){</p>
<p style="margin:0px;">                Cell cell = row<span style=" font-weight:600; color:#4682b4;">.</span>createCell(colNum);</p>
<p style="margin:0px;">                cell<span style=" font-weight:600; color:#4682b4;">.</span>setCellValue(colNum);</p>
<p style="margin:0px;">            }</p>
<p style="margin:0px;">        }</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        FileOutputStream fileOutputStream = <span style=" font-weight:600; color:#8b008b;">new</span> FileOutputStream(PATH + <span style=" font-weight:600; color:#2e8b57;">&quot;testWrite07BigFile.xlsx&quot;</span>);</p>
<p style="margin:0px;">        workbook<span style=" font-weight:600; color:#4682b4;">.</span>write(fileOutputStream);</p>
<p style="margin:0px;">        fileOutputStream<span style=" font-weight:600; color:#4682b4;">.</span>close();</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> endTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();      <span style=" font-style:italic; color:#778899;">//结束时间</span></p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println(<span style=" font-weight:600; color:#2e8b57;">&quot;over&quot;</span>);</p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println((<span style=" font-weight:600; color:#8b008b;">double</span>) (endTime-startTime)/<span style=" font-weight:600; color:#4682b4;">1000</span>);</p>
<p style="margin:0px;">    }</p>
<p style="margin:0px;">	<span style=" font-style:italic; color:#778899;">//升级版</span></p>
<p style="margin:0px;">    @Test</p>
<p style="margin:0px;">    <span style=" font-weight:600; color:#8b008b;">public</span> <span style=" font-weight:600; color:#8b008b;">void</span> testWrite07BigFileS() <span style=" font-weight:600; color:#8b008b;">throws</span> IOException {</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//时间</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> startTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();    <span style=" font-style:italic; color:#778899;">//开始时间</span></p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建工作簿</span></p>
<p style="margin:0px;">        Workbook workbook = <span style=" font-weight:600; color:#8b008b;">new</span> SXSSFWorkbook();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//创建表</span></p>
<p style="margin:0px;">        Sheet sheet = workbook<span style=" font-weight:600; color:#4682b4;">.</span>createSheet();</p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//写入数据</span></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> rowNum = <span style=" font-weight:600; color:#4682b4;">0</span>; rowNum &lt; <span style=" font-weight:600; color:#4682b4;">65536</span>; rowNum++){     <span style=" font-style:italic; color:#778899;">//循环每一行，每一列</span></p>
<p style="margin:0px;">            Row row = sheet<span style=" font-weight:600; color:#4682b4;">.</span>createRow(rowNum);</p>
<p style="margin:0px;">            <span style=" font-weight:600; color:#8b008b;">for</span> (<span style=" font-weight:600; color:#8b008b;">int</span> colNum = <span style=" font-weight:600; color:#4682b4;">0</span>; colNum &lt; <span style=" font-weight:600; color:#4682b4;">10</span>; colNum++){</p>
<p style="margin:0px;">                Cell cell = row<span style=" font-weight:600; color:#4682b4;">.</span>createCell(colNum);</p>
<p style="margin:0px;">                cell<span style=" font-weight:600; color:#4682b4;">.</span>setCellValue(colNum);</p>
<p style="margin:0px;">            }</p>
<p style="margin:0px;">        }</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        FileOutputStream fileOutputStream = <span style=" font-weight:600; color:#8b008b;">new</span> FileOutputStream(PATH + <span style=" font-weight:600; color:#2e8b57;">&quot;testWrite07BigFileS.xlsx&quot;</span>);</p>
<p style="margin:0px;">        workbook<span style=" font-weight:600; color:#4682b4;">.</span>write(fileOutputStream);</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        <span style=" font-style:italic; color:#778899;">//清空临时文件</span></p>
<p style="margin:0px;">        ((SXSSFWorkbook)workbook).dispose();</p>
<p style="margin:0px;">        fileOutputStream<span style=" font-weight:600; color:#4682b4;">.</span>close();</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>
<p style="margin:0px;">        <span style=" font-weight:600; color:#8b008b;">long</span> endTime = System<span style=" font-weight:600; color:#4682b4;">.</span>currentTimeMillis();      <span style=" font-style:italic; color:#778899;">//结束时间</span></p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println(<span style=" font-weight:600; color:#2e8b57;">&quot;over&quot;</span>);</p>
<p style="margin:0px;">        System<span style=" font-weight:600; color:#4682b4;">.</span>out<span style=" font-weight:600; color:#4682b4;">.</span>println((<span style=" font-weight:600; color:#8b008b;">double</span>) (endTime-startTime)/<span style=" font-weight:600; color:#4682b4;">1000</span>);</p>
<p style="margin:0px;">    }</p>
<p style="margin:0px;">}</p>
<p style="-qt-paragraph-type:empty; margin:0px;"><br /></p>

<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>