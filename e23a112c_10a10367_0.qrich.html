<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<meta name="qrichtext" content="1" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
p, li { white-space: pre-wrap; }
</style>
</head>
<body style="font-family:'微软雅黑'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">package</span><span style="font-family:'Courier';"> com</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mahe666;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> com</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">sun</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">MailSSLSocketFactory;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">activation</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">DataHandler;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">activation</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">FileDataSource;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail.*;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">internet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">InternetAddress;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">internet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">MimeBodyPart;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">internet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">MimeMessage;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> javax</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">mail</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">internet</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">MimeMultipart;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">security</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">GeneralSecurityException;</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">import</span><span style="font-family:'Courier';"> java</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">util</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">Properties;</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-style:italic; color:#778899;">//带图片的邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">class</span><span style="font-family:'Courier';"> ImageMail {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//和普通邮件相比，改动的只有创建邮件的步骤</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">public</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">static</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">void</span><span style="font-family:'Courier';"> main(String[] args) </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">throws</span><span style="font-family:'Courier';"> GeneralSecurityException, MessagingException {</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Properties prop = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> Properties();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.host&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp.qq.com&quot;</span><span style="font-family:'Courier';">);   </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置qq邮件服务器</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.transport.protocol&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp&quot;</span><span style="font-family:'Courier';">);     </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//邮件发送协议</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setProperty(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.auth&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;true&quot;</span><span style="font-family:'Courier';">);      </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//需要验证用户密码</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//关于QQ邮箱，还要设置SSL加密，加上以下代码即可,（阿里的钉钉邮箱也需要），其他邮箱看情况是否需要</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MailSSLSocketFactory sf = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MailSSLSocketFactory();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        sf</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setTrustAllHosts(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">true</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">put(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.ssl.enable&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;true&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        prop</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">put(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;mail.smtp.ssl.socketFactory&quot;</span><span style="font-family:'Courier';">,sf);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//使用JavaMail发送邮件的五个步骤</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//1，创建定义整个应用程序所需的环境信息的 Session 对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//QQ才有！其他邮箱看情况用</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Session session = Session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getDefaultInstance(prop, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> Authenticator() {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            @Override</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">protected</span><span style="font-family:'Courier';"> PasswordAuthentication getPasswordAuthentication() {</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">                </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">return</span><span style="font-family:'Courier';"> </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> PasswordAuthentication(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;授权码&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">            }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        });</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//开启Session的debug模式，这样就可以看到程序发送的Email的运行状态</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDebug(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">true</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//2，通过 session 得到 Transport 对象</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        Transport ts = session</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getTransport();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//3，使用邮箱的用户名和授权码连上邮件服务器</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">connect(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;smtp.qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;授权码&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//4，创建邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//注意需要传递session</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeMessage message = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeMessage(session);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//指明发件人</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setFrom(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> InternetAddress(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//指明收件人，如果发件人和收件人一样，那就是自己给自己发</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setRecipient(Message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">RecipientType</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">TO, </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> InternetAddress(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;3070449936@qq.com&quot;</span><span style="font-family:'Courier';">));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置邮件的主题</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSubject(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;easyTest&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置邮件的内容</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//准备图片数据</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart image = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//图片经过数据处理</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        DataHandler dh = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> DataHandler(</span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> FileDataSource(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;src/resources/xxx.jpg&quot;</span><span style="font-family:'Courier';">));</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        image</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setDataHandler(dh);   </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//在我们的Body主体中放入这个处理的图片数据</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        image</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContentID(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;xxx.jpg&quot;</span><span style="font-family:'Courier';">);  </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//给图片设置一个ID，我们在后面可以使用</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//准备正文数据</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeBodyPart text = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeBodyPart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//下面的cid就是上面setContentID的缩写，这里可以引用到那张图片</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        text</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContent(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;这是一封正文带图片&lt;img src='cid:xxx.jpg'&gt;的邮件&quot;</span><span style="font-family:'Courier';">,</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;text/html;charset=UTF-8&quot;</span><span style="font-family:'Courier';">);</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//描述数据关系</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        MimeMultipart mm = </span><span style="font-family:'Courier'; font-weight:600; color:#8b008b;">new</span><span style="font-family:'Courier';"> MimeMultipart();</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mm</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(text);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mm</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">addBodyPart(image);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        mm</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setSubType(</span><span style="font-family:'Courier'; font-weight:600; color:#2e8b57;">&quot;related&quot;</span><span style="font-family:'Courier';">);       </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//按照图里面的层级来，如果有附件，则是mixed</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//设置到消息中，保存修改</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">setContent(mm);</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">saveChanges();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//5，发送邮件</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">sendMessage(message, message</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">getAllRecipients());</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        </span><span style="font-family:'Courier'; font-style:italic; color:#778899;">//6，关闭连接</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">        ts</span><span style="font-family:'Courier'; font-weight:600; color:#4682b4;">.</span><span style="font-family:'Courier';">close();</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>
<p style="margin:0px;"><span style="font-family:'Courier';">    }</span></p>
<p style="margin:0px;"><span style="font-family:'Courier';">}</span></p>
<p style="-qt-paragraph-type:empty; margin:0px; font-family:'Courier';"><br /></p>

<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>